text = element_text(size = 16))
#P4.27
#1981: A bit more female
data_frame_81 %>%
count(sex_81,avoid_foreign_workers) %>%
group_by(sex_81) %>%
mutate(percent = (n / sum(n)) * 100) %>%
ungroup() %>%
filter(avoid_foreign_workers != "not checked") %>%
ggplot(aes(x = sex_81, y = percent)) +
geom_bar(stat = "identity", position = "dodge",fill = "#00BFC4")+
geom_text(aes(label=round(percent, digits = 2)), vjust=1.6, color="black", size=3.5)+
labs(title = "Respondents' sex compared to wish to avoid \nforeign workers 1981",
x = "Sex",
y = "Percentage of answers checked 'avoid foreign workers'") +
theme_replace() +
theme(axis.text.x = element_text(colour = "black", size = 15, angle = 0,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "black", size = 15),
text = element_text(size = 16))
#P4.27
#1981: A bit more female
data_frame_81 %>%
count(sex_81,avoid_foreign_workers) %>%
group_by(sex_81) %>%
mutate(percent = (n / sum(n)) * 100) %>%
ungroup() %>%
filter(avoid_foreign_workers != "not checked") %>%
ggplot(aes(x = sex_81, y = percent)) +
geom_bar(stat = "identity", position = "dodge",fill = "#00BFC4")+
geom_text(aes(label=round(percent, digits = 2)), vjust=1.6, color="black", size=3.5)+
labs(title = "Respondents' sex compared to wish to avoid \nforeign workers 1981",
x = "Sex",
y = "Percentage of answers checked 'avoid foreign workers'") +
theme_replace() +
theme(axis.text.x = element_text(colour = "black", size = 15, angle = 0,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "black", size = 15),
text = element_text(size = 16))
#P4.29
#1999: A bit more female
data_frame_99 %>%
count(sex_99,avoid_immigrants) %>%
group_by(sex_99) %>%
mutate(percent = (n / sum(n)) * 100) %>%
ungroup() %>%
filter(avoid_immigrants != "not checked") %>%
filter(avoid_immigrants != "dont know") %>%
ggplot(aes(x = sex_99, y = percent, fill = avoid_immigrants)) +
geom_bar(stat = "identity", position = "dodge",fill = "#00BFC4")+
geom_text(aes(label=round(percent, digits = 2)), vjust=1.6, color="black", size=3.5)+
labs(title = "Respondents' sex compared to wish to avoid \nimmigrants 1999",
x = "Sex",
y = "Percentage of answers checked 'avoid immmigrants'") +
theme_replace() +
theme(axis.text.x = element_text(colour = "black", size = 15, angle = 0,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "black", size = 15),
text = element_text(size = 16))
#P4.28
#1990: More male
data_frame_90 %>%
count(sex_90,avoid_foreign_workers) %>%
group_by(sex_90) %>%
mutate(percent = (n / sum(n)) * 100) %>%
ungroup() %>%
filter(avoid_foreign_workers != "not checked") %>%
ggplot(aes(x = sex_90, y = percent, fill = avoid_foreign_workers)) +
geom_bar(stat = "identity", position = "dodge",fill = "#FF6666")+
geom_text(aes(label=round(percent, digits = 2)), vjust=1.6, color="black", size=3.5)+
labs(title = "Respondents' sex compared to wish to avoid immigrants 1990",
x = "Sex",
y = "Percentage of answers checked 'avoid immmigrants'") +
theme_replace() +
theme(axis.text.x = element_text(colour = "black", size = 15, angle = 0,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "black", size = 15),
text = element_text(size = 16))
#P4.28
#1990: More male
data_frame_90 %>%
count(sex_90,avoid_foreign_workers) %>%
group_by(sex_90) %>%
mutate(percent = (n / sum(n)) * 100) %>%
ungroup() %>%
filter(avoid_foreign_workers != "not checked") %>%
ggplot(aes(x = sex_90, y = percent, fill = avoid_foreign_workers)) +
geom_bar(stat = "identity", position = "dodge",fill = "#00BFC4")+
geom_text(aes(label=round(percent, digits = 2)), vjust=1.6, color="black", size=3.5)+
labs(title = "Respondents' sex compared to wish to avoid immigrants 1990",
x = "Sex",
y = "Percentage of answers checked 'avoid immmigrants'") +
theme_replace() +
theme(axis.text.x = element_text(colour = "black", size = 15, angle = 0,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "black", size = 15),
text = element_text(size = 16))
#P4.31
#2017: More male
data_frame_17 %>%
count(sex_17,avoid_immigrants_foreign_workers) %>%
group_by(sex_17) %>%
mutate(percent = (n / sum(n)) * 100) %>%
ungroup() %>%
filter(avoid_immigrants_foreign_workers != "not checked") %>%
filter(avoid_immigrants_foreign_workers != "dont know") %>%
ggplot(aes(x = sex_17, y = percent)) +
geom_bar(stat = "identity", position = "dodge",fill = "#00BFC4")+
geom_text(aes(label=round(percent, digits = 2)), vjust=1.6, color="black", size=3.5)+
labs(title = "Respondents' sex compared to wish to avoid \nimmigrants 1999",
x = "Sex",
y = "Percentage of answers checked 'avoid immmigrants'") +
theme_replace() +
theme(axis.text.x = element_text(colour = "black", size = 15, angle = 0,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "black", size = 15),
text = element_text(size = 16))
#P4.28
#1990: More male
data_frame_90 %>%
count(sex_90,avoid_foreign_workers) %>%
group_by(sex_90) %>%
mutate(percent = (n / sum(n)) * 100) %>%
ungroup() %>%
filter(avoid_foreign_workers != "not checked") %>%
ggplot(aes(x = sex_90, y = percent, fill = avoid_foreign_workers)) +
geom_bar(stat = "identity", position = "dodge",fill = "#00BFC4")+
geom_text(aes(label=round(percent, digits = 2)), vjust=1.6, color="black", size=3.5)+
labs(title = "Respondents' sex compared to wish to avoid \nimmigrants 1990",
x = "Sex",
y = "Percentage of answers checked 'avoid immmigrants'") +
theme_replace() +
theme(axis.text.x = element_text(colour = "black", size = 15, angle = 0,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "black", size = 15),
text = element_text(size = 16))
R.version.string
versionInfo()
versionInfo()
packageVersion("rstudio")
view(data_frame_81)
View(data_frame_90)
view(data_frame_99)
VIEW(data_frame_08)
view(data_frame_08)
view(data_frame_17)
#2017
write_csv(data_frame_17, path = "data_output/data_frame_17.csv")
#2017
write_csv(data_frame_17, file = "data_output/data_frame_17.csv")
1981
write_csv(data_frame_81, file = "data_output/data_frame_81.csv")
#1990
write_csv(data_frame_90, file = "data_output/data_frame_90.csv")
#1999
write_csv(data_frame_99, file = "data_output/data_frame_99.csv")
#2008
write_csv(data_frame_08, file = "data_output/data_frame_08.csv")
#2017
write_csv(data_frame_17, file = "data_output/data_frame_17.csv")
source('~/Final project/scripts/data_organisation.R', encoding = 'UTF-8', echo=TRUE)
#P4.69
#2017: (if few jobs - should Danes be prioritized over immigrants?) Very short education: Allow; Short education: Dont allow; Long education: Allow
data_frame_17 %>%
count(education_17,allow_work_17) %>%
group_by(education_17) %>%
mutate(percent = (n / sum(n)) * 100) %>%
ungroup() %>%
filter(education_17 != "other") %>%
filter(education_17 != "NA") %>%
filter(allow_work_17 != "NA") %>%
ggplot(aes(x = education_17, y = percent, fill = allow_work_17)) +
geom_bar(stat = "identity", position = "dodge")+
theme(axis.text.x = element_text(colour = "grey20", size = 12, angle = 70,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "grey20", size = 12),
text = element_text(size = 16))
#P4.66
#1990: Shorter educations dont allow, longer allow
data_frame_90 %>%
count(education_90,allow_work_90) %>%
group_by(education_90) %>%
mutate(percent = (n / sum(n)) * 100) %>%
ungroup() %>%
filter(education_90 != "other") %>%
filter(education_90 != "NA") %>%
filter(allow_work_90 != "NA") %>%
ggplot(aes(x = education_90, y = percent, fill = allow_work_90)) +
geom_bar(stat = "identity", position = "dodge")+
theme(axis.text.x = element_text(colour = "grey20", size = 12, angle = 70,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "grey20", size = 12),
text = element_text(size = 16))
#P4.36
#2017: More (double amount) male
data_frame_17 %>%
count(sex_17,avoid_other_race) %>%
group_by(sex_17) %>%
mutate(percent = (n / sum(n)) * 100) %>%
ungroup() %>%
filter(avoid_other_race != "not checked") %>%
filter(avoid_other_race != "dont know") %>%
ggplot(aes(x = sex_17, y = percent, fill = avoid_other_race)) +
geom_bar(stat = "identity", position = "dodge")
#P1.13
#2008: Most 'limit amount of immigrants' (compared to 1990: more 'as long as there is jobs for danes' and more 'everybody allowed' )
data_frame_08 %>%
count(allow_work_08) %>%
mutate(percent = (n / sum(n)) * 100)%>%
filter(allow_work_08 != "NA") %>%
ggplot(aes(x = allow_work_08, y = percent)) +
geom_bar(stat = "identity", position = "dodge",fill = "#FF6666") +
coord_flip() +
geom_text(aes(label=round(percent, digits = 2)), vjust=1.6, color="black", size=3.5)+
labs(title = "Respondents' oppinion on foreign workers taking jobs 2008",
x = "Oppinion",
y = "Percentage of answers") +
theme_replace() +
theme(plot.title = element_text(hjust = 1.7, vjust=0),
axis.text.x = element_text(colour = "black", size = 15, angle = 0,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "black", size = 15),
text = element_text(size = 16))
data_frame_08 %>%
count(allow_work_08) %>%
mutate(percent = (n / sum(n)) * 100)%>%
filter(allow_work_08 != "NA")
data_frame_99 %>%
count(allow_work_99) %>%
mutate(percent = (n / sum(n)) * 100)%>%
filter(allow_work_99 != "NA")
source("~/Final project/scripts/data_organisation.R")
library(reshape)
#P2.6
#1990
owerview_1 <- data_frame_90 %>%
count(allow_work_90)
#P2.7
#1999
owerview_2 <- data_frame_99 %>%
count(allow_work_99)
merge(owerview_1, owerview_2, by = "row.names", all = TRUE)
source("~/Final project/scripts/data_organisation.R")
#Combining plot P4.27, P4.28, P4.29, P4.30, P4.31 - run following 7 pipelines
plot_4_27 <- data_frame_81 %>%
count(sex_81,avoid_foreign_workers) %>%
group_by(sex_81) %>%
mutate(percent = (n / sum(n)) * 100) %>%
mutate(year = "1981") %>%
ungroup() %>%
filter(avoid_foreign_workers != "not checked") %>%
rename(sex = sex_81,
avoid__immigrants_foreign_workers = avoid_foreign_workers)
plot_4_28 <- data_frame_90 %>%
count(sex_90,avoid_foreign_workers) %>%
group_by(sex_90) %>%
mutate(percent = (n / sum(n)) * 100) %>%
mutate(year = "1990") %>%
ungroup() %>%
filter(avoid_foreign_workers != "not checked")%>%
rename(sex = sex_90,
avoid__immigrants_foreign_workers = avoid_foreign_workers)
plot_4_29 <- data_frame_99 %>%
count(sex_99,avoid_immigrants) %>%
group_by(sex_99) %>%
mutate(percent = (n / sum(n)) * 100) %>%
mutate(year = "1999") %>%
ungroup() %>%
filter(avoid_immigrants != "not checked") %>%
filter(avoid_immigrants != "dont know")%>%
rename(sex = sex_99,
avoid__immigrants_foreign_workers = avoid_immigrants)
plot_4_30 <- data_frame_08 %>%
count(sex_08,avoid_immigrants) %>%
group_by(sex_08) %>%
mutate(percent = (n / sum(n)) * 100) %>%
mutate(year = "2008") %>%
ungroup() %>%
filter(avoid_immigrants != "not checked") %>%
filter(avoid_immigrants != "dont know")%>%
rename(sex = sex_08,
avoid__immigrants_foreign_workers = avoid_immigrants)
plot_4_31 <- data_frame_17 %>%
count(sex_17,avoid_immigrants_foreign_workers) %>%
group_by(sex_17) %>%
mutate(percent = (n / sum(n)) * 100) %>%
mutate(year = "2017") %>%
ungroup() %>%
filter(avoid_immigrants_foreign_workers != "not checked") %>%
filter(avoid_immigrants_foreign_workers != "dont know")%>%
rename(sex = sex_17,
avoid__immigrants_foreign_workers = avoid_immigrants_foreign_workers)
plot_4_27_31_combined <- rbind(plot_4_27,plot_4_28,plot_4_29,plot_4_30,plot_4_31)
plot_4_27_31_combined %>%
ggplot(aes(x = year, y = percent, fill = sex)) +
geom_bar(stat = "identity", position = "dodge")+
labs(title = "Respondents' sex compared to wish to avoid \nforeign workers 1981 to 2017",
x = "Year",
y = "Percentage of answers checked 'avoid foreign workers'",
fill = "Sex") +
theme_replace() +
theme(axis.text.x = element_text(colour = "black", size = 15, angle = 0,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "black", size = 15),
text = element_text(size = 16))+
scale_fill_manual("Sex", values = c("male" = "#F8766D", "female (housewife)" = "turquoise", "female (working)" = "cyan4", "female" = "#00BFC4"))
#P.2.1.2
#plot full
neighbour_sum_81 %>%
filter(status == "checked    ") %>%
ggplot(aes(x = reorder(avoid_who, -frequency), y = frequency, fill = status)) +
geom_bar(stat = "identity", position = "dodge")+
labs(title = "Who respondents would not like to be neighbour to 1981",
x = "Avoid who",
y = "Frequency") +
theme_replace() +
theme(axis.text.x = element_text(colour = "black", size = 15, angle = 40,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "black", size = 15),
text = element_text(size = 16))
(axis.text.x = element_text(colour = "black", size = 15, angle = 20,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "black", size = 15),
text = element_text(size = 16))
#P.2.1.3
#plot only xenophobia-related
neighbour_sum_81 %>%
filter(avoid_who %in% c("avoid_minority_sects","avoid_other_race")) %>%
filter(status != "NA's       ") %>%
ggplot(aes(x = avoid_who, y = frequency, fill = status)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Who respondents would not like to be neighbour to 1981",
x = "Avoid who",
y = "Frequency") +
theme_replace() +
theme(axis.text.x = element_text(colour = "black", size = 15, angle = 20,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "black", size = 15),
text = element_text(size = 16))
#P2.2
#1990
#P2.2.1
#dataframe
neighbour_sum_90 %>%
filter(status != "NA's       ") %>%
filter(status != "not checked") %>%
filter(status != "dont know  ") %>%
view()
source("~/Final project/scripts/data_organisation.R")
#P2.3.2
#plot full
neighbour_sum_99 %>%
filter(status == "checked    ") %>%
ggplot(aes(x = reorder(avoid_who, -frequency), y = frequency, fill = status)) +
geom_bar(stat = "identity", position = "dodge")+
labs(title = "Who respondents would not like to be neighbour to 1999",
x = "Avoid who",
y = "Frequency") +
theme_replace() +
theme(axis.text.x = element_text(colour = "black", size = 15, angle = 40,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "black", size = 15),
text = element_text(size = 16))
#P2.3.2
#plot full
neighbour_sum_99 %>%
filter(status == "checked    ") %>%
ggplot(aes(x = reorder(avoid_who, -frequency), y = frequency)) +
geom_bar(stat = "identity", position = "dodge")+
labs(title = "Who respondents would not like to be neighbour to 1999",
x = "Avoid who",
y = "Frequency") +
theme_replace() +
theme(axis.text.x = element_text(colour = "black", size = 15, angle = 40,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "black", size = 15),
text = element_text(size = 16))
geom_bar(stat = "identity", position = "dodge", fill = #FF6666")+
text = element_text(size = 16))
#P2.3.2
#plot full
neighbour_sum_99 %>%
filter(status == "checked    ") %>%
ggplot(aes(x = reorder(avoid_who, -frequency), y = frequency)) +
geom_bar(stat = "identity", position = "dodge", fill = "#FF6666")+
labs(title = "Who respondents would not like to be neighbour to 1999",
x = "Avoid who",
y = "Frequency") +
theme_replace() +
theme(axis.text.x = element_text(colour = "black", size = 15, angle = 40,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "black", size = 15),
text = element_text(size = 16))
#P2.3.2
#plot full
neighbour_sum_99 %>%
filter(status == "checked    ") %>%
ggplot(aes(x = reorder(avoid_who, -frequency), y = frequency)) +
geom_bar(stat = "identity", position = "dodge", fill = "#FF6666")+
labs(title = "Who respondents would not like to be neighbour with 1999",
x = "Avoid who",
y = "Frequency") +
theme_replace() +
theme(axis.text.x = element_text(colour = "black", size = 15, angle = 40,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "black", size = 15),
text = element_text(size = 16))
#P2.3.2
#plot full
neighbour_sum_99 %>%
filter(status == "checked    ") %>%
ggplot(aes(x = reorder(avoid_who, -frequency), y = frequency)) +
geom_bar(stat = "identity", position = "dodge", fill = "#FF6666")+
labs(title = "Who respondents would not like to be neighbour with 1999",
x = "Avoid who",
y = "Frequency") +
theme_replace() +
theme(axis.text.x = element_text(colour = "black", size = 15, angle = 60,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "black", size = 15),
text = element_text(size = 16))
#P2.3.2
#plot full
neighbour_sum_99 %>%
filter(status == "checked    ") %>%
ggplot(aes(x = reorder(avoid_who, -frequency), y = frequency)) +
geom_bar(stat = "identity", position = "dodge", fill = "#FF6666")+
labs(title = "Who respondents would not like to be neighbour with in 1999",
x = "Avoid who",
y = "Frequency") +
theme_replace() +
theme(axis.text.x = element_text(colour = "black", size = 15, angle = 60,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "black", size = 15),
text = element_text(size = 16))
#P1.11
#1990 (question: are immigrants allowed to work if there are not enough jobs for Danes) Most allow
data_frame_90 %>%
count(allow_work_90) %>%
mutate(percent = (n / sum(n)) * 100)%>%
ggplot(aes(x = allow_work_90, y = percent)) +
geom_bar(stat = "identity", position = "dodge",fill = "#FF6666") +
geom_text(aes(label=round(percent, digits = 2)), vjust=1.6, color="white", size=3.5) +
coord_flip() +
geom_text(aes(label=round(percent, digits = 2)), vjust=1.6, color="black", size=3.5)+
labs(title = "Respondents' oppinion on foreign workers taking jobs 1990",
x = "Oppinion",
y = "Percentage of answers") +
theme_replace() +
theme(plot.title = element_text(hjust = 1.7, vjust=0),
axis.text.x = element_text(colour = "black", size = 15, angle = 0,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "black", size = 15),
text = element_text(size = 16))
#P1.12
#1999: Most 'limit amount of immigrants'
data_frame_99 %>%
count(allow_work_99) %>%
mutate(percent = (n / sum(n)) * 100)%>%
filter(allow_work_99 != "NA") %>%
ggplot(aes(x = allow_work_99, y = percent)) +
geom_bar(stat = "identity", position = "dodge",fill = "#FF6666") +
geom_text(aes(label=round(percent, digits = 2)), vjust=1.6, color="white", size=3.5) +
coord_flip() +
geom_text(aes(label=round(percent, digits = 2)), vjust=1.6, color="black", size=3.5)+
labs(title = "Respondents' oppinion on foreign workers taking jobs 1999",
x = "Oppinion",
y = "Percentage of answers") +
theme_replace() +
theme(plot.title = element_text(hjust = 1.7, vjust=0),
axis.text.x = element_text(colour = "black", size = 15, angle = 0,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "black", size = 15),
text = element_text(size = 16))
#P1.13
#2008: Most 'limit amount of immigrants' (compared to 1990: more 'as long as there is jobs for danes' and more 'everybody allowed' )
data_frame_08 %>%
count(allow_work_08) %>%
mutate(percent = (n / sum(n)) * 100)%>%
filter(allow_work_08 != "NA") %>%
ggplot(aes(x = allow_work_08, y = percent)) +
geom_bar(stat = "identity", position = "dodge",fill = "#FF6666") +
coord_flip() +
geom_text(aes(label=round(percent, digits = 2)), vjust=1.6, color="black", size=3.5)+
labs(title = "Respondents' oppinion on foreign workers taking jobs 2008",
x = "Oppinion",
y = "Percentage of answers") +
theme_replace() +
theme(plot.title = element_text(hjust = 1.7, vjust=0),
axis.text.x = element_text(colour = "black", size = 15, angle = 0,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "black", size = 15),
text = element_text(size = 16))
#P1.14
#2017 (if few jobs - should Danes be prioritized over immigrants?) Most: 'dont agree and 'either or' - tendency of resentmen against foreign workers
data_frame_17 %>%
count(allow_work_17) %>%
mutate(percent = (n / sum(n)) * 100)%>%
filter(allow_work_17 != "NA") %>%
ggplot(aes(x = allow_work_17, y = percent)) +
geom_bar(stat = "identity", position = "dodge",fill = "#FF6666") +
coord_flip() +
geom_text(aes(label=round(percent, digits = 2)), vjust=1.6, color="black", size=3.5)+
labs(title = "Respondents' oppinion on foreign workers taking jobs 2017",
x = "Oppinion",
y = "Percentage of answers") +
theme_replace() +
theme(plot.title = element_text(hjust = 3.5, vjust=0),
axis.text.x = element_text(colour = "black", size = 15, angle = 0,
hjust = 0.5, vjust = 0.5),
axis.text.y = element_text(colour = "black", size = 15),
text = element_text(size = 16))
